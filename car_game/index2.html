<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>스네이크게임</title>
    <style>
        body{
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            background-color:#f0f0f0;
        }
        #gameArea{
            position: relative;
            width: 500px;
            height: 500px;
            background: #fff;
            border: 1px solid #333;
        }
        .food{
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: red;
        }
        .snake{
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: pink;
        }
    </style>
    <script src="js/jquery-1.12.4.min.js"></script>
    <script>
        $(document).ready(function(){
            const gameArea = $("#gameArea");
            const areaSize = 500;
            const cellSize = 20;
            let snake = [{x:0, y:0}];
            let direction = 'right';
            let food = {x:0, y:0};

            function createFood(){ //뱀의 먹이를 만드는 함수
                food.x = Math.floor(Math.random() * (areaSize / cellSize)) * cellSize;
                food.y = Math.floor(Math.random() * (areaSize / cellSize)) * cellSize;
                gameArea.append(`<div class="food" style="left:${food.x}px; top:${food.y}px;"></div>`);
            }

            function moveSnake(){
                const head = {x: snake[0].x, y: snake[0].y};
                
                switch(direction){
                    case "right" : head.x +=cellSize; break;
                    case "left" : head.x -=cellSize; break;
                    case "up" : head.y -=cellSize; break;
                    case "down" : head.y +=cellSize; break;
                }
           

                if(head.x >= areaSize 
                        || head.x <0 
                        || head.y >=areaSize   
                        || head.y <0 || snakeCollision(head)){
                    alert("gameover");
                    location.reload();
                    return;
                }

                snake.unshift(head);

                if(head.x === food.x && head.y === food.y) {
                    $(".food").remove();
                    createFood();
                }else{
                    snake.pop();
                }

                createSnake();

            };

            function snakeCollision(head){
                for(let i = 1; i < snake.length; i++) {
                    if(snake[i].x === head.x && snake[i].y === head.y){
                        return true;
                    }
                }
                return false;
            }            

            function createSnake(){
                gameArea.find(".snake").remove();
                snake.forEach(function(segment){
                    gameArea.append(`<div class="snake" 
                                     style="left:${segment.x}px; top:${segment.y}px"></div>`);
                });
                
            }
            $(document).keydown(function(e){
                switch(e.which){
                    case 37: direction = "left"; break;
                    case 38: direction = "up"; break;
                    case 39: direction = "right"; break;
                    case 40: direction = "down"; break;
                }
            });

            createFood();
            setInterval(moveSnake, 200);
        });
    </script>
</head>
<body>
    <h1>zoile's Snake Game</h1>
    <div id="gameArea"></div>

</body>
</html>